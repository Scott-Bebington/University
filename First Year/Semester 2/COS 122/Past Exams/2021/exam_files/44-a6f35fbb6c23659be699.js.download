(window.webpackJsonp=window.webpackJsonp||[]).push([[44,144],{"/3bX":function(e,s,t){var i=t("ziER"),o=t("5JeM"),r=new i({id:"icon-medium-box",use:"icon-medium-box-usage",viewBox:"0 0 24 24",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-medium-box"><path stroke-width="1.95" d="M17.186 17.398l5.936-7.287M17.225 10.134l5.896 7.235" /><ellipse stroke-width="1.1" ry=".387" rx=".456" cy="10.249" cx="23.016" /><ellipse stroke-width="1.1" ry=".387" rx=".456" cy="17.273" cx="17.304" /><ellipse stroke-width="1.1" ry=".387" rx=".456" cy="17.273" cx="23.029" /><ellipse stroke-width="1.1" ry=".387" rx=".456" cy="10.249" cx="17.304" /><ellipse stroke-width="1.9" ry="3.618" rx="3.606" cy="13.755" cx="12.38" /><ellipse stroke-width="1.9" ry="3.618" rx="3.606" cy="13.755" cx="4.481" /><ellipse stroke-width="1.1" ry=".387" rx=".4" cy="6.399" cx=".898" /><path stroke-width="1.6" d="M.806 7.04h.219v5.871H.806z" /></symbol>'});o.add(r);e.exports=r},"4WO5":function(e,s,t){"use strict";var i=t("D57K"),o=(t("l+9M"),t("68Mn"),t("dV61"),t("6s5h"),t("IfWz"),t("/3bX"),t("MOE3"),t("imEv"),t("nsO7")),r=t("lut3"),n=t("0JpG"),a=t("fYJU"),l=t("Vsv2"),c=t("12mu"),d=t("pjml"),u=t("gbHk"),h=t("emI2"),p=t("lEL+"),m=t("Q/M7"),b=t("tkGi");function w(e){let s=e;return/^\+?\d+$/.test(e)||(s=e.replace(/[^\+\d]/g,"")),s}var v=t("zGdY"),f=t("c+ks"),g=t("NDLj"),P=t("aHpC");t.d(s,"c",(function(){return y})),t.d(s,"b",(function(){return k})),t.d(s,"a",(function(){return O}));const y="ultra.base.profile.controller",k=r.a;let _=class{constructor(e,s,t,i,o,r,n,a,c,d,h,p,m,w,v,f,g,P){this.$window=e,this.$document=s,this.$http=t,this.$timeout=i,this.$scope=o,this.userConfiguration=r,this.isMobileDistributorActive=n,this.contextUser=a,this.cloudDriveService=c,this.UserModel=d,this.modal=h,this.prefService=p,this.timeout=m,this.LanguagesModel=w,this.bbLocalize=v,this.NotificationGeneralSettings=f,this.PrivacyPolicyModel=g,this.kloudService=P,this.personalKloudlessAccounts=[],this.isCloudServiceAvailable=!1,this.cloudServiceSupportsPersistentAccounts=!1,o.baseProfile=this,this.UserModel.$find("me").$asPromise().then(e=>{this.loadCurrentUser(e)}),this.cloudDriveService.isCloudServiceAvailable(l.a.KLOUDLESS).then(e=>{this.isCloudServiceAvailable=e,this.initializeKloudless()}),f.$build().$fetch().$then(e=>{o.isSmsOn="A"===e.settings.sms_setting.attributeValue}),this.$scope.$on(k,(e,s)=>{this.loadCurrentUser(s),a._setUserModel(s)}),this.$scope.$on(u.b,e=>{this.msgModal=this.showChangePasswordSuccessMessage(),this.closeChangePasswordSuccessMessage(this.msgModal,2e3)}),this.$scope.$on(b.a,(e,s)=>{this.setUpLanguages(s)}),this.PrivacyPolicyModel.getPrivacyPolicy().then(e=>{this.privacyPolicy=e})}showChangePasswordSuccessMessage(){return this.modal.open({scope:this.$scope,template:f,resolve:{translations:[n.serviceName,e=>e.loadBundle("features/base/profile/base-profile")]}})}closeChangePasswordSuccessMessage(e,s){e&&this.timeout(()=>{e.dismiss()},this.$scope,s)}hasPermissionToAddPronouns(){var e,s;return!!(null===(s=null===(e=this.user)||void 0===e?void 0:e.permissions)||void 0===s?void 0:s.fieldPermissions.pronouns)}userHasPronouns(){var e;return!!(null===(e=this.user)||void 0===e?void 0:e.pronouns)}pronounAriaLabel(){return this.userHasPronouns()?"base.profile.pronouns.edit":"base.profile.pronouns.add"}userPronouns(){var e;return null===(e=this.user)||void 0===e?void 0:e.pronouns}loadCurrentUser(e){this.user=e,this.LanguagesModel.$collection().$fetch({limit:1e4}).$then(e=>{this.languages=e,this.setUpLanguages(this.user.locale)}),this.user.permissions.fieldPermissions||(this.user.permissions.fieldPermissions={},o.values(this.userConfiguration).forEach(e=>{o.set(this.user.permissions.fieldPermissions,e.fieldName,this.user.permissions.editAccountInfo&&e.isEditable)})),this.user.mobilePhone&&(this.user.mobilePhone=w(this.user.mobilePhone)),this.user.homePhone1&&(this.user.homePhone1=w(this.user.homePhone1)),this.user.businessPhone1&&(this.user.businessPhone1=w(this.user.businessPhone1))}userHasPhoneNumber(){return this.user&&(this.user.businessPhone1||this.user.homePhone1||this.user.mobilePhone)}userCanEditPhoneNumber(){return this.user&&this.user.permissions.fieldPermissions&&(this.user.permissions.fieldPermissions.businessPhone1||this.user.permissions.fieldPermissions.homePhone1||this.user.permissions.fieldPermissions.mobilePhone)}userHasMailingAddress(){return this.user&&(this.user.street1||this.user.street2||this.user.city||this.user.state||this.user.zipCode||this.user.country)}userCanEditMailingAddress(){return this.user&&this.user.permissions.fieldPermissions&&(this.user.permissions.fieldPermissions.street1||this.user.permissions.fieldPermissions.street2||this.user.permissions.fieldPermissions.city||this.user.permissions.fieldPermissions.state||this.user.permissions.fieldPermissions.zipCode||this.user.permissions.fieldPermissions.country)}showAdditionalInformation(){return this.user&&this.user.permissions.fieldPermissions&&(this.user.permissions.fieldPermissions.gender||this.user.gender&&this.user.gender!==v.Gender.Unknown||this.user.permissions.fieldPermissions.otherName||this.user.otherName||this.user.permissions.fieldPermissions.birthDate||this.user.birthDate||this.user.permissions.fieldPermissions.educationLevel||this.user.educationLevel&&this.user.educationLevel!==v.EducationLevel.Unknown||this.user.permissions.fieldPermissions.webPage||this.user.webPage)}showContactInformation(){return this.user&&this.user.permissions.fieldPermissions&&(this.userCanEditMailingAddress()||this.userHasMailingAddress()||this.userHasPhoneNumber()||this.userCanEditPhoneNumber()||this.user.permissions.fieldPermissions.businessFax||this.user.businessFax)}showJobInformation(){return this.user&&this.user.permissions.fieldPermissions&&(this.user.permissions.fieldPermissions.company||this.user.company||this.user.permissions.fieldPermissions.jobTitle||this.user.jobTitle||this.user.permissions.fieldPermissions.department||this.user.department)}openUserWebPage(){m.o(this.user.webPage)}setUpLanguages(e){this.userLanguage=o.find(this.languages,s=>s.locale===e),this.systemDefaultLanguage=o.find(this.languages,"isDefault"),this.translatedSystemDefaultLanguageLabel=this.bbLocalize.translateSync({key:"base.profile.language.systemDefault",params:{systemDefaultLanguage:this.systemDefaultLanguage.name},noEscape:!0,noWrap:!0,locale:this.systemDefaultLanguage.locale})}getUserPrivacyAriaKey(){const e=this.contextUser.userModel.visibilityScope.toString().toLowerCase();return`base.profile.privacySettings.edit.${this.contextUser.userModel.isInstructor()?"instructors":"others"}.${e}`}initializeKloudless(){return this.kloudService.supportsPersistentAccounts().then(e=>(this.cloudServiceSupportsPersistentAccounts=e,this.kloudService.getInstitutionAccount().then(e=>{this.instAccountInfo=e}).then(()=>this.initializeKloudlessAccounts())))}initializeKloudlessAccounts(){this.kloudService.getKloudlessAccounts().then(e=>{this.instKloudlessAccount=void 0,this.personalKloudlessAccounts=[],e.forEach(e=>{e.service===this.instAccountInfo.type&&e.name.endsWith("@"+this.instAccountInfo.domain)?this.instKloudlessAccount=e:this.personalKloudlessAccounts.push(e)})})}getCloudStorageName(e){return this.kloudService.getCloudStorageIcon(e)}connectInstitutionKloudless(){this.kloudService.launchInstitutionAccount(this.instAccountInfo).then(()=>{this.initializeKloudlessAccounts()})}connectPersonalKloudless(){this.kloudService.connectPersonalAccount().then(()=>{this.initializeKloudlessAccounts()})}deleteKloudlessAccount(e){this.kloudService.deleteKloudlessAccount(e).then(()=>{this.initializeKloudlessAccounts()})}hasInstAccountInfo(){return this.instAccountInfo&&this.instAccountInfo.type&&this.instAccountInfo.domain&&("onedrivebiz"===this.instAccountInfo.type||"gdrive"===this.instAccountInfo.type)}};_=Object(i.__decorate)([Object(i.__param)(0,Object(P.b)("$window")),Object(i.__param)(1,Object(P.b)("$document")),Object(i.__param)(2,Object(P.b)("$http")),Object(i.__param)(3,Object(P.b)("$timeout")),Object(i.__param)(4,Object(P.b)("$scope")),Object(i.__param)(5,Object(P.b)("userConfiguration")),Object(i.__param)(6,Object(P.b)("isMobileDistributorActive")),Object(i.__param)(7,Object(P.b)(a.b)),Object(i.__param)(8,Object(P.b)(l.c)),Object(i.__param)(9,Object(P.b)(d.Jb.serviceName)),Object(i.__param)(10,Object(P.b)(c.b)),Object(i.__param)(11,Object(P.b)(h.c)),Object(i.__param)(12,Object(P.b)(p.b)),Object(i.__param)(13,Object(P.b)(d.J.serviceName)),Object(i.__param)(14,Object(P.b)(n.serviceName)),Object(i.__param)(15,Object(P.b)(d.P.serviceName)),Object(i.__param)(16,Object(P.b)(d.jb.serviceName)),Object(i.__param)(17,Object(P.b)(g.b))],_);class O extends _{}},"68Mn":function(e,s,t){var i=t("ziER"),o=t("5JeM"),r=new i({id:"icon-small-stop-action",use:"icon-small-stop-action-usage",viewBox:"0 0 16 16",content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-stop-action"><path fill="none" stroke-miterlimit="10" d="M7.955.456c-4.142 0-7.5 3.358-7.5 7.5s3.358 7.5 7.5 7.5 7.5-3.358 7.5-7.5-3.357-7.5-7.5-7.5h0z" /><path fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M5.673 5.673h4.565v4.565H5.673z" /><path fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M6.325 6.325h3.261v3.261H6.325z" /><path fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M6.162 6.162h3.587v3.587H6.162z" /><path fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M6.977 6.977h1.957v1.957H6.977z" /><path fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M6.814 6.814h2.283v2.283H6.814z" /><path fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M7.629 7.629h.652v.652h-.652z" /><path fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M7.466 7.466h.978v.978h-.978z" /></symbol>'});o.add(r);e.exports=r},"6s5h":function(e,s,t){var i=t("ziER"),o=t("5JeM"),r=new i({id:"icon-medium-onedrivebiz",use:"icon-medium-onedrivebiz-usage",viewBox:"0 0 24 24",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-medium-onedrivebiz"><path stroke-width="2.2" d="M8.8 18.6c-1.1 0-2-.9-2-2s.9-2 2-2h1l.1-1c.2-1.6 1.6-2.8 3.2-2.8 1 0 1.9.4 2.5 1.2l.6.8.8-.4c.4-.2.7-.3 1.1-.3 1.4 0 2.5 1.1 2.5 2.5v1l1 .1c.4 0 .8.2 1 .5.2.2.2.4.2.7v.2c0 .9-.6 1.5-1.5 1.5H8.8z" /><path stroke-width="2.2" d="M8.8 17.2c-.3 0-.6-.3-.6-.6s.3-.6.6-.6h2.3l.3-2.3c.1-.8.9-1.5 1.8-1.5.6 0 1.1.2 1.4.6l1.3 1.7 1.9-1c.1-.1.3-.1.5-.1.6 0 1.1.5 1.1 1.1v2.3l2.0833.2-.0833.1H8.8v.1z" /><path stroke-width="2.2" d="M16.4 15.8l1.4-.7v.7h-1.4zm-3.9 0l.2-1.9c0-.1.2-.3.3-.3.1 0 .2 0 .2.1l1.6 2.1h-2.3z" /><path stroke-width="1.1" d="M3.3 17.8c-1.4 0-2.7-1.3-2.7-2.7 0-1.3 1-2.4 2.4-2.6l.8-.1-.3-.7c-.1-.1-.1-.3-.1-.5 0-1.9 1.5-3.5 3.5-3.5.7 0 1.4.2 1.9.5l.5.2.2-.5c.7-1.4 2.2-2.3 3.9-2.3 2.2 0 4 1.5 4.4 3.4-.3 0-.5.1-.7.2-1.1-.9-2.4-1.3-3.8-1.3-2.5 0-4.8 1.6-5.7 4-2.2.5-3.6 2.5-3.6 4.7 0 .4 0 .8.1 1.2h-.8z" /><path stroke-width="2" d="M3.1 16.9c-.9-.1-1.7-.9-1.7-1.9 0-.9.7-1.6 1.7-1.8l1.1-.2c-.7 1-1.1 2.2-1.1 3.4v.5zM4.2 11.3c-.1-.3 0-.5.1-.9.1-.3.2-.5.3-.7.3-.4.7-.8 1.2-1 .3-.1.6-.2 1-.2.5.1 1.2.3 1.6.5-.6.6-1.2 1.3-1.5 2.2-.8.3-1.5.8-2.1 1.4 0-.1-.2-.4-.2-.4-.2-.4-.3-.6-.4-.9z" /><path d="M16.1 7.6c-.9-.4-1.8-.6-2.9-.6-.8 0-1.6.2-2.4.4.6-.6 1.5-1 2.5-1 1.1 0 2.2.5 2.8 1.2zM16.1 7.6l1 .9" /><path stroke-width="2" d="M6.6 9.5l-1.4 1.4M12.7 15.7h5.1" /><path stroke-width=".5" d="M9.742 7.983h.633v.55h-.633z" /></symbol>'});o.add(r);e.exports=r},IfWz:function(e,s,t){var i=t("ziER"),o=t("5JeM"),r=new i({id:"icon-medium-gdrive",use:"icon-medium-gdrive-usage",viewBox:"0 0 24 24",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-medium-gdrive"><path stroke-width="4" d="M7.481 7.4388l1.189 2.081-2.329 4.0338-1.189-2.081 2.329-4.0338z" /><path stroke-width="4" d="M5.3476 11.1388l1.189 2.081-2.329 4.0338-1.189-2.081 2.329-4.0338zM13.6147 19.5662l1.2334-2.1144h4.7574l-1.2334 2.1144h-4.7574z" /><path stroke-width="4" d="M9.364 19.5662l1.2333-2.1144h4.7574l-1.2334 2.1144H9.364zM17.1374 8.4873l-2.3708-.0106-2.304-3.9905 2.371.0107 2.3038 3.9904h0z" /><path stroke-width="4" d="M19.3393 12.2794l-2.3709-.0106-2.304-3.9905 2.371.0106 2.3039 3.9905z" /></symbol>'});o.add(r);e.exports=r},MOE3:function(e,s,t){var i=t("ziER"),o=t("5JeM"),r=new i({id:"icon-medium-dropbox",use:"icon-medium-dropbox-usage",viewBox:"0 0 24 24",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-medium-dropbox"><path stroke-width="3.5" d="M9.1 18.6l2.9-1.9 2.8 1.9-2.8 1.8z" /><path stroke-width="3.4" d="M3.2 13.5L6 11.6l2.9 1.9L6 15.3zM15.1 13.5l2.9-1.9 2.8 1.9-2.8 1.8zM3.2 5.8L6 4l2.9 1.8L6 7.6zM15.1 5.8L18 4l2.8 1.8L18 7.6z" /></symbol>'});o.add(r);e.exports=r},NDLj:function(e,s,t){"use strict";t.d(s,"a",(function(){return h})),t.d(s,"b",(function(){return p}));var i=t("D57K"),o=t("Llzl"),r=t("z6Q5"),n=t("0JpG"),a=t("Vsv2"),l=t("pjml"),c=t("emI2"),d=t("OBf2"),u=t("aHpC");const h="ultra.service.kloudless",p="kloudless";let m=class{constructor(e,s,t,i,o,r,n){this.$q=e,this.$timeout=s,this.batchService=t,this.bbLocalize=i,this.cloudDrive=o,this.SystemPreferenceModel=r,this.preferences=n,this.initializeRequired=!0}getInstitutionAccount(){const e=new d.a;return e.type="disabled",this.batchService.performBatch(()=>this.$q.all([this.SystemPreferenceModel.$find("institution_cloud_storage_provider_type").$allow([404]).$asPromise(),this.SystemPreferenceModel.$find("institution_cloud_storage_domain").$allow([404]).$asPromise()]).then(s=>(s&&(e.type=this.getPreferenceValueByKey(s,"institution_cloud_storage_provider_type"),e.domain=this.getPreferenceValueByKey(s,"institution_cloud_storage_domain")),e)))}getKloudlessAccounts(){let e=[];return this.preferences.getPreference(d.c,"[]").then(s=>(s&&s.value&&(e=JSON.parse(s.value)),e))}getConnectedInstitutionAccount(e,s){let t=null;return s&&s.forEach(s=>{s.service===e.type&&s.name.endsWith(e.domain)&&(t=s)}),t}getCloudStorageIcon(e){switch(e){case"gdrive":return"gdrive";case"onedrivebiz":return"onedrivebiz";case"box":return"box";case"dropbox":return"dropbox";case"skydrive":return"skydrive";default:return""}}authenticateCallBack(e){if(e.error)throw new Error("Unable to authenticate account: "+e.error);const s={id:e.account.id,name:e.account.account,service:e.account.service,bearer_token:{key:e.access_token}};this.preferences.getPreference(d.c).then(e=>{const t=JSON.parse(e.value).filter(e=>e.id!==s.id);t.push(s),this.preferences.setPreference(d.c,JSON.stringify(t)),this.accountsInitialized.resolve()}).catch(()=>{const e=[];e.push(s),this.preferences.setPreference(d.c,JSON.stringify(e)),this.accountsInitialized.resolve()})}launchAuthenticator(e,s){this.cloudDrive.isCloudServiceAvailable(a.a.KLOUDLESS).then(()=>{const t=this.cloudDrive.cloudDriveStorage[a.a.KLOUDLESS.toString()],i=this.getKloudlessInfo(),o=this.authenticateCallBack.bind(this);if(t.authenticator){let r="";r=e?s:"gdrive onedrivebiz box dropbox skydrive",t.authenticator(null,{client_id:i.client_id,base_url:i.base_url,scope:r},o).launch()}else console.error("Authenticator is not available")})}initAuthenticationDeferred(){return!this.initializeRequired&&this.accountsInitialized||(this.accountsInitialized=this.$q.defer(),this.initializeRequired=!1),this.accountsInitialized}launchInstitutionAccount(e,s){return this.initializeRequired=!0,this.initAuthenticationDeferred(),this.getKloudlessAccounts().then(t=>{const i=this.getConnectedInstitutionAccount(e,t);null===i?this.launchAuthenticator(!0,e.type):this.launchToService(i,s)}),this.accountsInitialized.promise}connectPersonalAccount(){return this.initializeRequired=!0,this.initAuthenticationDeferred(),this.launchAuthenticator(!1,void 0),this.accountsInitialized.promise}getPreferenceValueByKey(e,s){const t=e.find(e=>e.key===s);return t?t.value:null}deleteKloudlessAccount(e){return this.getKloudlessAccounts().then(s=>{const t=s.filter(s=>s.id!==e);return this.preferences.setPreference(d.c,JSON.stringify(t)),t})}getOneDriveLink(e){const s=this.$q.defer(),t=`${this.getKloudlessInfo().base_url}/v1/accounts/${e.id}?retrieve_tokens=true`;return fetch(t,{method:"GET",headers:{Authorization:"Bearer "+e.bearer_token.key}}).then(e=>{e.json().then(e=>{try{const t=JSON.parse(e.token).oauth.split("."),i=JSON.parse(window.atob(t[1]));s.resolve(i.aud)}catch(e){s.reject(e.message)}})}).catch(e=>{s.reject(e.message)}),s.promise}launchToService(e,s){switch(this.initAuthenticationDeferred(),e.service){case"gdrive":this.getInstitutionAccount().then(s=>{if("gdrive"===s.type&&e.name.endsWith(s.domain)){const s=e.name.substring(e.name.indexOf("@")+1);window.open("https://drive.google.com/a/"+s,"_blank")}else window.open("https://drive.google.com/drive/u/0/","_blank")});break;case"onedrivebiz":s?window.open(s,"_blank"):this.getOneDriveLink(e).then(e=>{window.open(e,"_blank")}).catch(e=>{console.error(e)});break;case"skydrive":window.open("https://onedrive.live.com","_blank");break;case"dropbox":window.open("https://www.dropbox.com/h","_blank");break;case"box":window.open("https://www.box.com","_blank")}}getKloudlessInfo(){return this.cloudDrive.cloudDriveStorage[a.a.KLOUDLESS.toString()].getKloudlessInfo()}supportsPersistentAccounts(){return this.cloudDrive.isCloudServiceAvailable(a.a.KLOUDLESS).then(()=>{return!this.cloudDrive.cloudDriveStorage[a.a.KLOUDLESS.toString()].version.includes("uppy")}).catch(e=>!0)}};m=Object(i.__decorate)([Object(i.__param)(0,Object(u.b)("$q")),Object(i.__param)(1,Object(u.b)("$timeout")),Object(i.__param)(2,Object(u.b)(r.b)),Object(i.__param)(3,Object(u.b)(n.serviceName)),Object(i.__param)(4,Object(u.b)(a.c)),Object(i.__param)(5,Object(u.b)(l.qb.serviceName)),Object(i.__param)(6,Object(u.b)(c.c))],m);class b extends m{}o.module(h,[l.N,c.b,r.a]).service(p,m)},"c+ks":function(e,s){e.exports='<bb-modal class="notification change-password"\n          modal-title-key="base.profile.update-password.successModal.title"\n          analytics-id-tag-prefix="base.profile.update.password.closeSuccessModal">\n  <div name="modal-contents">\n    <p bb-translate>base.profile.update-password.successModal.description</p>\n  </div>\n  \x3c!-- htmlhint:analytics-id:disable --\x3e\n  <button name="modal-footer-button-primary"\n          class="button"\n          ng-click="$parent.$close()"\n          bb-translate\n          analytics-id="features.base.profile.update.password.closeSuccessModal.button">global.ok</button>\n  \x3c!-- htmlhint:analytics-id:enable --\x3e\n</bb-modal>'},dV61:function(e,s,t){var i=t("ziER"),o=t("5JeM"),r=new i({id:"icon-small-trash",use:"icon-small-trash-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-trash"><path d="M4 4l2-3h4l2 3M2 5l1 10h10l1-10M1 4h14M8 7v5M11 7l-.5 5M5 7l.5 5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});o.add(r);e.exports=r},gbHk:function(e,s,t){"use strict";t.d(s,"c",(function(){return n})),t.d(s,"b",(function(){return a})),t.d(s,"a",(function(){return c}));t("GkCm");var i=t("fYJU"),o=t("pjml"),r=t("TnpK");const n="profile.update-password.controller",a="password-changed";class l{constructor(e,s,t,i,o,r,n){this.$rootScope=e,this.$scope=s,this.$modal=t,this.$q=i,this.UserModel=o,this.ultraStateService=r,this.contextUser=n,this.userHasOldPassword=!0,this.isSaving=!1,this.oldPwdIsValid=!1,this.newPwdIsValid=!1,this.newConfirmedPwdIsValid=!1,s.updatePassword=this,this.loadCurrentUser()}loadCurrentUser(){this.UserModel.$find(this.contextUser.userId).$asPromise().then(e=>{this.user=e})}persist(){if(this.isSaving)return this.$q.when();let e;this.isSaving=!0;const s=this.getTrimmedNewPassword();return s&&(this.oldPassword&&(this.user.inputOldPassword=this.oldPassword),this.user.password=s,e=this.user.$patch().$asPromise().then(e=>{this.ultraStateService.leavePeekState(this.ultraStateService.current.name).then(()=>{this.$rootScope.$broadcast(a)})}).catch(e=>{this.$scope.updatePasswordForm.$setPristine(),400===e.$response.status&&(this.setValidity("old-password",l.INVALID_OLD_PASSWORD,!1),e.$response.status=null)}).finally(()=>{this.isSaving=!1})),e||this.$q.when()}getTrimmedNewPassword(){return this.newPassword?this.newPassword.trim():""}setValidity(e,s,t){const i=this.$scope.updatePasswordForm[e];i&&s&&i.$setValidity(s,t)}validate(e){const s=this.getTrimmedNewPassword();this.oldPwdIsValid=!this.userHasOldPassword||!!this.oldPassword,this.newPwdIsValid=!!s,this.newConfirmedPwdIsValid=this.newPassword===this.confirmNewPassword,e||(this.setValidity("old-password","required",!!this.oldPassword),this.setValidity("new-password","required",!!this.newPassword),this.setValidity("new-password","cannotBeWhiteSpace",!!s),this.setValidity("confirm-new-password","required",!!this.confirmNewPassword),this.setValidity("confirm-new-password","differentWithNewPassword",this.newConfirmedPwdIsValid))}clearValidationForOldPwd(){this.setValidity("old-password","required",!0);const e=this.$scope.updatePasswordForm["old-password"];e&&!e.$valid&&e.$setValidity(l.INVALID_OLD_PASSWORD,!0)}clearValidationForNewPwd(){this.setValidity("new-password","required",!0),this.setValidity("new-password","cannotBeWhiteSpace",!0)}clearValidationForConfirmedNewPwd(){this.setValidity("confirm-new-password","required",!0),this.setValidity("confirm-new-password","differentWithNewPassword",!0)}isPasswordAllValid(){return this.oldPwdIsValid&&this.newPwdIsValid&&this.newConfirmedPwdIsValid}}l.INVALID_OLD_PASSWORD="invalidOldPassword",l.$inject=["$rootScope","$scope","$modal","$q",o.Jb.serviceName,r.d,i.b];class c extends l{}},imEv:function(e,s,t){var i=t("ziER"),o=t("5JeM"),r=new i({id:"icon-medium-skydrive",use:"icon-medium-skydrive-usage",viewBox:"0 0 24 24",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-medium-skydrive"><path stroke-width="2.2" d="M8.8 18.6c-1.1 0-2-.9-2-2s.9-2 2-2h1l.1-1c.2-1.6 1.6-2.8 3.2-2.8 1 0 1.9.4 2.5 1.2l.6.8.8-.4c.4-.2.7-.3 1.1-.3 1.4 0 2.5 1.1 2.5 2.5v1l1 .1c.4 0 .8.2 1 .5.2.2.2.4.2.7v.2c0 .9-.6 1.5-1.5 1.5H8.8z" /><path stroke-width="2.2" d="M8.8 17.2c-.3 0-.6-.3-.6-.6s.3-.6.6-.6h2.3l.3-2.3c.1-.8.9-1.5 1.8-1.5.6 0 1.1.2 1.4.6l1.3 1.7 1.9-1c.1-.1.3-.1.5-.1.6 0 1.1.5 1.1 1.1v2.3l2.0833.2-.0833.1H8.8v.1z" /><path stroke-width="2.2" d="M16.4 15.8l1.4-.7v.7h-1.4zm-3.9 0l.2-1.9c0-.1.2-.3.3-.3.1 0 .2 0 .2.1l1.6 2.1h-2.3z" /><path stroke-width="1.1" d="M3.3 17.8c-1.4 0-2.7-1.3-2.7-2.7 0-1.3 1-2.4 2.4-2.6l.8-.1-.3-.7c-.1-.1-.1-.3-.1-.5 0-1.9 1.5-3.5 3.5-3.5.7 0 1.4.2 1.9.5l.5.2.2-.5c.7-1.4 2.2-2.3 3.9-2.3 2.2 0 4 1.5 4.4 3.4-.3 0-.5.1-.7.2-1.1-.9-2.4-1.3-3.8-1.3-2.5 0-4.8 1.6-5.7 4-2.2.5-3.6 2.5-3.6 4.7 0 .4 0 .8.1 1.2h-.8z" /><path stroke-width="2" d="M3.1 16.9c-.9-.1-1.7-.9-1.7-1.9 0-.9.7-1.6 1.7-1.8l1.1-.2c-.7 1-1.1 2.2-1.1 3.4v.5zM4.2 11.3c-.1-.3 0-.5.1-.9.1-.3.2-.5.3-.7.3-.4.7-.8 1.2-1 .3-.1.6-.2 1-.2.5.1 1.2.3 1.6.5-.6.6-1.2 1.3-1.5 2.2-.8.3-1.5.8-2.1 1.4 0-.1-.2-.4-.2-.4-.2-.4-.3-.6-.4-.9z" /><path d="M16.1 7.6c-.9-.4-1.8-.6-2.9-.6-.8 0-1.6.2-2.4.4.6-.6 1.5-1 2.5-1 1.1 0 2.2.5 2.8 1.2zM16.1 7.6l1 .9" /><path stroke-width="2" d="M6.6 9.5l-1.4 1.4M12.7 15.7h5.1" /><path stroke-width=".5" d="M9.742 7.983h.633v.55h-.633z" /></symbol>'});o.add(r);e.exports=r},"l+9M":function(e,s,t){var i=t("ziER"),o=t("5JeM"),r=new i({id:"icon-small-draw",use:"icon-small-draw-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-draw"><path d="M15 4l-3-3L2 11l-1 4 4-1L15 4zM12 6l-2-2M6 12l-2-2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});o.add(r);e.exports=r},tkGi:function(e,s,t){"use strict";t.d(s,"c",(function(){return h})),t.d(s,"a",(function(){return p})),t.d(s,"b",(function(){return m}));var i=t("D57K"),o=(t("GkCm"),t("nsO7")),r=t("nmzr"),n=t("0JpG"),a=t("TnpK"),l=t("m2oH"),c=t("pjml"),d=t("fYJU"),u=t("aHpC");const h="ultra.features.base.profile.update.userLanguage.controller",p="language-changed";let m=class{constructor(e,s,t,i,r,n,a,l){this.$scope=e,this.$rootScope=s,this.$http=t,this.$window=i,this.contextUser=r,this.bbLocalize=n,this.LanguagesModel=a,this.ultraState=l,this.isSaving=!1,e.userLanguage=this,this.user=r.userModel,this.originalUserLocale=this.user.locale,a.$collection().$fetch({limit:1e4}).$then(e=>{this.languages=o.filter(e,"isUserEnabled"),this.systemDefaultLanguage=o.find(e,"isDefault"),this.systemDefaultLanguageOptionName=this.bbLocalize.translateSync({key:"base.profile.language.systemDefault",params:{systemDefaultLanguage:this.systemDefaultLanguage.name},noEscape:!0,noWrap:!0,locale:this.user.locale}),o.some(this.languages,e=>e.locale===this.user.locale)||(this.user.locale=null)})}setLocation(e){this.$window.location.href=e}reloadUltra(){const e=new URL(this.ultraState.href(r.ProfileRoutes.PROFILE_BASE));e.searchParams.append("noCache","true"),this.setLocation(e.href)}persist(){return this.isSaving=!0,""===this.user.locale&&(this.user.locale=null),this.user.$patch().$asPromise().then(()=>{var e;if(this.bbLocalize.isRTL()!==Object(l.a)(null!==(e=this.user.locale)&&void 0!==e?e:this.bbLocalize.defaultLocale))return void this.reloadUltra();this.isSaving=!1,this.bbLocalize.setUserLocale(this.user.locale);const s=this.user.locale||this.bbLocalize.getAppLocale();this.bbLocalize.setLocale(this.$rootScope,s).then(()=>{this.$rootScope.$broadcast(p,s),this.ultraState.go(r.ProfileRoutes.PROFILE_BASE)})}).then(()=>this.user)}validate(){return!0}cancelClicked(){this.user.locale=this.originalUserLocale,this.persist(),this.ultraState.go(r.ProfileRoutes.PROFILE_BASE)}};m=Object(i.__decorate)([Object(i.__param)(0,Object(u.b)("$scope")),Object(i.__param)(1,Object(u.b)("$rootScope")),Object(i.__param)(2,Object(u.b)("$http")),Object(i.__param)(3,Object(u.b)("$window")),Object(i.__param)(4,Object(u.b)(d.b)),Object(i.__param)(5,Object(u.b)(n.serviceName)),Object(i.__param)(6,Object(u.b)(c.J.serviceName)),Object(i.__param)(7,Object(u.b)(a.d))],m);class b extends m{}}}]);